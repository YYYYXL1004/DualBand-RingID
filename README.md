# DualBand-RingID: åŒé¢‘å¸¦æ°´å°è¯†åˆ«ç³»ç»Ÿ

> åŸºäº Tree-Ring å’Œ RingID çš„å¤šä¾›åº”å•†å›¾åƒæ°´å°è¯†åˆ«ä¸é²æ£’æ€§å¢å¼ºç ”ç©¶

## é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„å›¾åƒæ°´å°ç³»ç»Ÿï¼Œç»“åˆäº†é¢‘åŸŸæ°´å°æŠ€æœ¯ã€å¤šå¯†é’¥è¯†åˆ«èƒ½åŠ›å’ŒæŠ—æ”»å‡»å¢å¼ºæ–¹æ³•ã€‚é¡¹ç›®åŸºäº [Tree-Ring Watermark](https://github.com/YuxinWenRick/tree-ring-watermark) å’Œ [RingID](http://arxiv.org/abs/2404.14055) è®ºæ–‡ï¼Œå¹¶å¼•å…¥äº† [PAI (Path-Aware Injection)](https://arxiv.org/abs/2601.06639) è¯­ä¹‰åè½¬æŠ€æœ¯ã€‚

### å›¢é˜Ÿåˆ†å·¥

| æˆå‘˜ | ç ”ç©¶æ–¹å‘ | ä¸»è¦è´¡çŒ® |
|------|----------|----------|
| **æˆå‘˜ A** | åŒé¢‘å¸¦ç­–ç•¥ + PAI é›†æˆ | æå‡ºåŒé¢‘å¸¦æ°´å°æ–¹æ¡ˆï¼Œå®ç° PAI è¯­ä¹‰åè½¬å¢å¼ºæŠ—ç¯¡æ”¹èƒ½åŠ› |
| **æˆå‘˜ B** | å¤šå¯†é’¥è¯†åˆ«éªŒè¯ | åœ¨ RingID æ¡†æ¶ä¸‹éªŒè¯åŒé¢‘å¸¦ç­–ç•¥ï¼Œæ¢ç´¢å¯†é’¥å®¹é‡å’ŒPAIåè½¬æ•ˆæœ |
| **æˆå‘˜ C** | å›¾åƒè´¨é‡è¯„ä¼° | å®ç° PSNR/SSIM è´¨é‡æ£€æµ‹ï¼Œè¯„ä¼°ä¸åŒé¢‘æ®µç­–ç•¥çš„è§†è§‰å½±å“ |
| **æˆå‘˜ D** | æ•°æ®æ±‡æ€»ä¸æŠ¥å‘Šæ’°å†™ | æ•´åˆå®éªŒæ•°æ®ï¼Œç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ï¼Œæ’°å†™æŠ€æœ¯æŠ¥å‘Šåˆç¨¿ |

### æŠ€æœ¯è·¯çº¿

```
Tree-Ring å•å¯†é’¥éªŒè¯ (æˆå‘˜ A)
    â†“
åŒé¢‘å¸¦ç­–ç•¥æå‡º (Low-Freq + High-Freq)
    â†“
PAI è¯­ä¹‰åè½¬é›†æˆ (æŠ—ç¯¡æ”¹å¢å¼º)
    â†“
RingID å¤šå¯†é’¥è¯†åˆ«éªŒè¯ (æˆå‘˜ B)
    â†“
å›¾åƒè´¨é‡è¯„ä¼° (æˆå‘˜ C)
    â†“
æ•°æ®æ±‡æ€»ä¸æŠ¥å‘Šæ’°å†™ (æˆå‘˜ D)
```

### åä½œæµç¨‹

```mermaid
graph LR
    A[æˆå‘˜ A: ç”Ÿæˆæ°´å°å›¾åƒ] --> C[æˆå‘˜ C: è´¨é‡è¯„ä¼°]
    A --> B[æˆå‘˜ B: å¤šå¯†é’¥è¯†åˆ«]
    B --> D[æˆå‘˜ D: æ•°æ®æ±‡æ€»]
    C --> D
    D --> E[æŠ€æœ¯æŠ¥å‘Š]
```

| é˜¶æ®µ | è¾“å…¥ | è¾“å‡º | è´Ÿè´£äºº |
|------|------|------|--------|
| 1. æ°´å°ç”Ÿæˆ | Prompts | å¸¦æ°´å°å›¾åƒ | A |
| 2. è´¨é‡è¯„ä¼° | å¸¦æ°´å°å›¾åƒ | PSNR/SSIM æ•°æ® | C |
| 3. è¯†åˆ«éªŒè¯ | å¸¦æ°´å°å›¾åƒ | è¯†åˆ«å‡†ç¡®ç‡ã€æ··æ·†çŸ©é˜µ | B |
| 4. æ•°æ®æ±‡æ€» | æ‰€æœ‰å®éªŒæ•°æ® | ç»Ÿè®¡åˆ†æã€å¯è§†åŒ–å›¾è¡¨ | D |
| 5. æŠ¥å‘Šæ’°å†™ | æ±‡æ€»æ•°æ® | æŠ€æœ¯æŠ¥å‘Š | D |

## æ ¸å¿ƒç ”ç©¶æˆæœ

### å…³é”®å‘ç°æ€»ç»“

| å‘ç° | æè¿° | è´¡çŒ®è€… |
|------|------|--------|
| ğŸ¯ **åŒé¢‘å¸¦ä¼˜äºå•é¢‘** | åœ¨ Tree-Ring å’Œ RingID ä¸¤ç§åœºæ™¯ä¸‹å‡éªŒè¯æœ‰æ•ˆ | A + B + D |
| ğŸ“Š **å®¹é‡ä¸Šé™ 20-30** | å®ç”¨å¤šå¯†é’¥è¯†åˆ«å®¹é‡ä¸º 20-30 ä¸ªä¾›åº”å•† | B + D |
| âš–ï¸ **PAI Trade-off** | PAI åœ¨å•å¯†é’¥åœºæ™¯ AUC=1.0ï¼Œä½†åœ¨å¤šå¯†é’¥åœºæ™¯é™ä½å‡†ç¡®ç‡ 1-2% | A + B + D |
| ğŸ–¼ï¸ **è§†è§‰è´¨é‡ä¿æŒ** | åŒé¢‘å¸¦ç­–ç•¥ PSNR > 40dBï¼ŒPAI å¢å¼ºç‰ˆ SSIM > 0.96 | C + D |
| ğŸ›¡ï¸ **PAI é«˜é²æ£’æ€§** | æŠ—å¸¸è§æ”»å‡»ä¿æŒç‡ > 85%ï¼ŒTPR=96%, TNR=100% | A + D |

### 1. åŒé¢‘å¸¦ç­–ç•¥ (æˆå‘˜ A æå‡º + æˆå‘˜ B éªŒè¯)

#### Tree-Ring åœºæ™¯ (å•å¯†é’¥éªŒè¯)
| ç­–ç•¥ | PSNR (dB) | SSIM | è§†è§‰è´¨é‡ |
|------|-----------|------|----------|
| ä½é¢‘ (R=3-7) | 42.15 | 0.9876 | é«˜ |
| é«˜é¢‘ (R=8-14) | 38.92 | 0.9654 | ä¸­ |
| **åŒé¢‘å¸¦ (R=3-14)** | **40.58** | **0.9782** | **ä¼˜** âœ“ |

**æˆå‘˜ C è¯„ä¼°ç»“è®º**ï¼šåŒé¢‘å¸¦ç­–ç•¥åœ¨ä¿æŒé«˜è§†è§‰è´¨é‡çš„åŒæ—¶ï¼Œå…¼é¡¾äº†é²æ£’æ€§ã€‚

#### RingID åœºæ™¯ (å¤šå¯†é’¥è¯†åˆ«)
| ç­–ç•¥ | Clean | C&S75 | å¹³å‡å‡†ç¡®ç‡ |
|------|-------|-------|------------|
| ä½é¢‘ (R=3-7) | 100% | 88% | 97.7% |
| é«˜é¢‘ (R=8-14) | 100% | 80% | 96.6% |
| **åŒé¢‘å¸¦ (R=3-14)** | 100% | **90%** | **98.3%** âœ“ |

**æˆå‘˜ B éªŒè¯ç»“è®º**ï¼šåŒé¢‘å¸¦ç­–ç•¥åœ¨å¤šä¾›åº”å•†è¯†åˆ«åœºæ™¯ä¸‹**åŒæ ·è¡¨ç°æœ€ä¼˜**ï¼ŒéªŒè¯äº†å…¶æ™®é€‚æ€§ã€‚

### 2. å¯†é’¥å®¹é‡æµ‹è¯• (æˆå‘˜ B)

| å¯†é’¥æ•° | å¹³å‡å‡†ç¡®ç‡ | C&S75 |
|--------|------------|-------|
| 5 | 98.3% | 90% |
| 10 | 96.4% | 78% |
| 20 | 95.4% | 71% |
| 30 | 93.4% | 58% |
| 50 | 91.7% | 48% |

**ç»“è®º**ï¼šå®ç”¨å¯†é’¥å®¹é‡ä¸º **20-30** ä¸ªä¾›åº”å•†ã€‚

### 3. PAI è¯­ä¹‰åè½¬ (æˆå‘˜ A å®ç° + æˆå‘˜ B è¯„ä¼°)

#### å•å¯†é’¥éªŒè¯åœºæ™¯ (Tree-Ring + PAI)

**å›¾åƒè´¨é‡**ï¼š
- PSNR: **26.21 dB**
- SSIM: **0.9688**

**æ£€æµ‹æ€§èƒ½**ï¼š
| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| å¸¦æ°´å°å›¾åƒç›¸ä¼¼åº¦ | 0.3658 Â± 0.0365 |
| æ— æ°´å°å›¾åƒç›¸ä¼¼åº¦ | 0.2182 Â± 0.0068 |
| æ£€æµ‹é—´éš™ (Gap) | **0.1476** |
| AUC | **1.0000** |
| æ£€æµ‹é˜ˆå€¼ | 0.2920 |
| çœŸé˜³æ€§ç‡ (TPR) | **96.00%** |
| çœŸé˜´æ€§ç‡ (TNR) | **100.00%** |

**é²æ£’æ€§æµ‹è¯•**ï¼š
| æ”»å‡»ç±»å‹ | ç›¸ä¼¼åº¦ | ä¿æŒç‡ |
|----------|--------|--------|
| æ— æ”»å‡» (Baseline) | 0.3658 Â± 0.0365 | 100% |
| é«˜æ–¯å™ªå£° | 0.3417 Â± 0.0385 | 93.4% |
| é«˜æ–¯æ¨¡ç³Š | 0.3162 Â± 0.0383 | 86.4% |
| JPEG å‹ç¼© | 0.3492 Â± 0.0389 | 95.5% |
| äº®åº¦è°ƒæ•´ | 0.3550 Â± 0.0323 | 97.0% |
| å°ºå¯¸ç¼©æ”¾ | 0.3476 Â± 0.0376 | 95.0% |
| è£å‰ª | 0.2201 Â± 0.0078 | 60.2% |

**æˆå‘˜ A ç»“è®º**ï¼š
- âœ… **å®Œç¾åˆ†ç¦»**: AUC = 1.0ï¼Œå¸¦æ°´å°å’Œæ— æ°´å°å›¾åƒå®Œå…¨å¯åŒºåˆ†
- âœ… **é«˜é²æ£’æ€§**: é™¤è£å‰ªå¤–ï¼Œæ‰€æœ‰æ”»å‡»ä¸‹ç›¸ä¼¼åº¦ä¿æŒç‡ > 85%
- âœ… **è§†è§‰è´¨é‡**: SSIM > 0.96ï¼Œè§†è§‰ä¸Šå‡ ä¹æ— æŸ
- âš ï¸ **è£å‰ªæ•æ„Ÿ**: è£å‰ªæ”»å‡»ä¸‹æ€§èƒ½ä¸‹é™è‡³ 60%ï¼ˆé¢‘åŸŸæ°´å°çš„å›ºæœ‰é™åˆ¶ï¼‰

#### å¤šå¯†é’¥è¯†åˆ«åœºæ™¯ (RingID + PAI åè½¬)
| é…ç½® | C&S75 | å¹³å‡å‡†ç¡®ç‡ |
|------|-------|------------|
| **Baseline (æ— åè½¬)** | **90%** | **98.3%** |
| åè½¬ (s=5, m=0.1) | 84% | 97.4% |
| åè½¬ (s=5, m=0.3) | 78% | 96.1% |

**æˆå‘˜ B å‘ç°**ï¼šåœ¨å¤šå¯†é’¥è¯†åˆ«åœºæ™¯ä¸‹ï¼Œè·¯å¾„åè½¬ä¸è¯†åˆ«å‡†ç¡®ç‡å­˜åœ¨ **trade-off**ã€‚

#### PAI åº”ç”¨åœºæ™¯å¯¹æ¯”

| åœºæ™¯ | åè½¬æ•ˆæœ | é€‚ç”¨æ€§ | æ¨èé…ç½® |
|------|----------|--------|----------|
| å•å¯†é’¥éªŒè¯ (Tree-Ring) | âœ… æ˜¾è‘—æå‡æŠ—æ”»å‡»<br>TPR=96%, TNR=100% | **å¼ºçƒˆæ¨è** | æ ‡å‡† PAI é…ç½® |
| å¤šå¯†é’¥è¯†åˆ« (RingID) | âš ï¸ é™ä½è¯†åˆ«å‡†ç¡®ç‡<br>å‡†ç¡®ç‡ä¸‹é™ 1-2% | éœ€æƒè¡¡ | ä½å¼ºåº¦åè½¬ (mâ‰¤0.1) |
| ç‰ˆæƒä¿æŠ¤ | âœ… é«˜é²æ£’æ€§<br>æŠ—å¸¸è§æ”»å‡» > 85% | æ¨èä½¿ç”¨ | æ ‡å‡† PAI é…ç½® |
| ä¾›åº”å•†æº¯æº | âš ï¸ å½±å“å¤šå¯†é’¥åŒºåˆ† | è°¨æ…ä½¿ç”¨ | å»ºè®®å…³é—­åè½¬ |

## ç¯å¢ƒé…ç½®

### ç³»ç»Ÿè¦æ±‚
- Python 3.8+
- CUDA 11.0+ (æ¨è RTX 4060 8GB æˆ–æ›´é«˜)
- 20GB+ ç£ç›˜ç©ºé—´

### å®‰è£…ä¾èµ–

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
conda create -n dualband python=3.8
conda activate dualband

# å®‰è£…ä¾èµ–
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
pip install diffusers==0.11.1 transformers==4.23.1
pip install numpy tqdm pillow xformers accelerate safetensors
pip install opencv-python scikit-image  # ç”¨äºå›¾åƒè´¨é‡è¯„ä¼°
```

### æ¨¡å‹ä¸‹è½½

ä¸‹è½½ Stable Diffusion 2.1 Base æ¨¡å‹ï¼š
```bash
# æ–¹æ³• 1: ä½¿ç”¨ Hugging Face
from diffusers import StableDiffusionPipeline
pipe = StableDiffusionPipeline.from_pretrained("stabilityai/stable-diffusion-2-1-base")
pipe.save_pretrained("./models/stable-diffusion-2-1-base")

# æ–¹æ³• 2: æ‰‹åŠ¨ä¸‹è½½
# ä¸‹è½½åœ°å€: https://huggingface.co/stabilityai/stable-diffusion-2-1-base
```

### Prompt æ•°æ®é›†

ä¸‹è½½ [Gustavosta/Stable-Diffusion-Prompts](https://huggingface.co/datasets/Gustavosta/Stable-Diffusion-Prompts) æˆ–ä½¿ç”¨é¡¹ç›®æä¾›çš„ `prompts_for_alignment.txt`ã€‚

## ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹ï¼ˆ5 åˆ†é’Ÿä½“éªŒï¼‰

```bash
# 1. ç”Ÿæˆå¸¦æ°´å°å›¾åƒ
python shuiyin.py

# 2. è¯„ä¼°å›¾åƒè´¨é‡
python test.py

# 3. è¿è¡Œå¤šå¯†é’¥è¯†åˆ«
python identify.py --run_name quickstart --trials 10 --assigned_keys 5 --gpu_id 0
```

### è¯¦ç»†å®éªŒæŒ‡å—

#### å®éªŒ 1: åŒé¢‘å¸¦æ°´å°ç”Ÿæˆ (æˆå‘˜ A)

**åŸºç¡€ç‰ˆæœ¬**ï¼š
```bash
python shuiyin.py
```
é…ç½®è¯´æ˜ï¼š
- è‡ªåŠ¨ç”Ÿæˆ Low-Freqã€High-Freqã€Dual-Ring ä¸‰ç§ç­–ç•¥
- é»˜è®¤ç”Ÿæˆ 50 å¼ å›¾åƒ
- ç»“æœä¿å­˜è‡³ `tree_ring_results/`

**PAI å¢å¼ºç‰ˆæœ¬**ï¼š
```bash
python PAI.py
```
é…ç½®è¯´æ˜ï¼š
- é›†æˆè¯­ä¹‰åè½¬æŠ€æœ¯
- å¢å¼ºæŠ—æ”»å‡»èƒ½åŠ›
- ç»“æœä¿å­˜è‡³ `pai_results/`

#### å®éªŒ 2: å›¾åƒè´¨é‡è¯„ä¼° (æˆå‘˜ C)

```bash
python test.py
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
Folder Name     | Avg PSNR (dB)   | Avg SSIM
---------------------------------------------
Dual-Ring       |         40.5823 |     0.9782
Low-Freq        |         42.1534 |     0.9876
High-Freq       |         38.9245 |     0.9654
```

#### å®éªŒ 3: å¤šå¯†é’¥è¯†åˆ«æµ‹è¯• (æˆå‘˜ B)

**3.1 é¢‘æ®µç­–ç•¥å¯¹æ¯”**
```bash
python scripts/frequency_band_test.py --gpu 0
```
- å¯¹æ¯” Low-Freqã€High-Freqã€Dual-Band ä¸‰ç§ç­–ç•¥
- ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Šè‡³ `runs/frequency_band_comparison/`

**3.2 å¯†é’¥å®¹é‡æµ‹è¯•**
```bash
python scripts/key_capacity_test.py --keys 5,10,20,30,50 --gpu 0
```
- æµ‹è¯•ä¸åŒå¯†é’¥æ•°é‡ä¸‹çš„è¯†åˆ«å‡†ç¡®ç‡
- ç”Ÿæˆå®¹é‡æ›²çº¿è‡³ `runs/key_capacity_test/`

**3.3 PAI åè½¬æ•ˆæœè¯„ä¼°**
```bash
# Baseline (æ— åè½¬)
python identify.py --use_deflection 0 --assigned_keys 5 --trials 100 --gpu_id 0

# å•æ¬¡åè½¬å®éªŒ
python identify.py --use_deflection 1 --deflection_steps 5 --deflection_strength 0.3 \
    --assigned_keys 5 --trials 100 --gpu_id 0

# æ‰¹é‡åè½¬å®éªŒï¼ˆä¸åŒå‚æ•°ç»„åˆï¼‰
bash scripts/run_deflection_experiments.sh
```

**3.4 ç”Ÿæˆæ··æ·†çŸ©é˜µ**
```bash
python scripts/generate_confusion_matrix.py --run_dir runs/2026_01_13_11_56_25_multi_key_5vendors_v2
```

## é¡¹ç›®ç»“æ„

```
DualBand-RingID/
â”œâ”€â”€ shuiyin.py                  # æˆå‘˜ A: Tree-Ring åŒé¢‘å¸¦æ°´å°ç”Ÿæˆ
â”œâ”€â”€ PAI.py                      # æˆå‘˜ A: PAI è¯­ä¹‰åè½¬å¢å¼ºç‰ˆæœ¬
â”œâ”€â”€ test.py                     # æˆå‘˜ C: å›¾åƒè´¨é‡è¯„ä¼° (PSNR/SSIM)
â”œâ”€â”€ identify.py                 # æˆå‘˜ B: å¤šå¯†é’¥è¯†åˆ«ä¸»ç¨‹åº
â”œâ”€â”€ utils.py                    # æ ¸å¿ƒå·¥å…·å‡½æ•°
â”œâ”€â”€ inverse_stable_diffusion.py # DDIM é€†å‘æ¨ç†
â”œâ”€â”€ modified_stable_diffusion.py# ä¿®æ”¹ç‰ˆ SD pipeline
â”œâ”€â”€ io_utils.py                 # è¾“å…¥è¾“å‡ºå·¥å…·
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ frequency_band_test.py  # æˆå‘˜ B: é¢‘æ®µå¯¹æ¯”å®éªŒ
â”‚   â”œâ”€â”€ key_capacity_test.py    # æˆå‘˜ B: å¯†é’¥å®¹é‡æµ‹è¯•
â”‚   â”œâ”€â”€ run_deflection_experiments.sh  # æˆå‘˜ B: PAI åè½¬æ‰¹é‡å®éªŒ
â”‚   â”œâ”€â”€ generate_confusion_matrix.py   # æˆå‘˜ B: æ··æ·†çŸ©é˜µç”Ÿæˆ
â”œâ”€â”€ runs/                       # å®éªŒç»“æœç›®å½•
â”‚   â”œâ”€â”€ frequency_band_comparison/  # é¢‘æ®µå¯¹æ¯”ç»“æœ
â”‚   â”œâ”€â”€ key_capacity_test/          # å®¹é‡æµ‹è¯•ç»“æœ
â”‚   â””â”€â”€ 2026_01_*_*/                # å„æ¬¡å®éªŒè¿è¡Œè®°å½•
â”œâ”€â”€ tree_ring_results/          # æˆå‘˜ A: Tree-Ring ç”Ÿæˆç»“æœ
â”œâ”€â”€ pai_results/                # æˆå‘˜ A: PAI å¢å¼ºç»“æœ
â”œâ”€â”€ models/                     # Stable Diffusion æ¨¡å‹
â”œâ”€â”€ sd_prompts_dataset/         # Prompt æ•°æ®é›†
â””â”€â”€ requirements.txt            # ä¾èµ–åˆ—è¡¨
```

## æŠ€æœ¯ç»†èŠ‚

### åŒé¢‘å¸¦ç­–ç•¥åŸç†

ä¼ ç»Ÿ Tree-Ring æ°´å°ä»…ä½¿ç”¨å•ä¸€é¢‘æ®µï¼ˆé€šå¸¸æ˜¯ä½é¢‘ï¼‰ï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
- **ä½é¢‘**ï¼šé²æ£’æ€§å¼ºä½†å®¹æ˜“è¢«å‹ç¼©æ”»å‡»ç ´å
- **é«˜é¢‘**ï¼šæŠ—å‹ç¼©ä½†å®¹æ˜“è¢«æ¨¡ç³Šæ”»å‡»ç ´å

**åŒé¢‘å¸¦æ–¹æ¡ˆ**ç»“åˆä¸¤è€…ä¼˜åŠ¿ï¼š
```
ä½é¢‘ç¯ (R=3-7)  â† æŠ—æ¨¡ç³Šã€æŠ—å‡ ä½•å˜æ¢
     +
é«˜é¢‘ç¯ (R=8-14) â† æŠ—å‹ç¼©ã€æŠ—å™ªå£°
     â†“
åŒé¢‘å¸¦æ°´å° (R=3-14) â† ç»¼åˆé²æ£’æ€§æœ€ä¼˜
```

### PAI è¯­ä¹‰åè½¬æœºåˆ¶

PAI (Path-Aware Injection) é€šè¿‡åœ¨æ‰©æ•£è¿‡ç¨‹ä¸­æ³¨å…¥æ„ŸçŸ¥åŠ æƒçš„é¢‘åŸŸä¿¡å·ï¼Œå®ç°è¯­ä¹‰ä¿æŒçš„åŒæ—¶å¢å¼ºæ°´å°é²æ£’æ€§ã€‚

#### æ ¸å¿ƒåŸç†

**é¢‘åŸŸæ³¨å…¥å…¬å¼**ï¼š
```
W(f) = (1 - Î±Â·M_sÂ·M_p)Â·L(f) + Î±Â·M_sÂ·M_pÂ·T(f)
```
å…¶ä¸­ï¼š
- `L(f)`: åŸå§‹æ½œå˜é‡é¢‘åŸŸè¡¨ç¤º
- `T(f)`: ç›®æ ‡æ°´å° Patchï¼ˆå›ºå®šéšæœºç§å­ç”Ÿæˆï¼‰
- `M_s`: ç©ºé—´æ©ç ï¼ˆé¢‘æ®µé€‰æ‹©ï¼Œæ”¯æŒåŒé¢‘å¸¦ï¼‰
- `M_p`: æ„ŸçŸ¥æƒé‡ï¼ˆè‡ªé€‚åº”è®¡ç®—ï¼Œä¿æŠ¤é‡è¦é¢‘ç‡æˆåˆ†ï¼‰
- `Î±`: æ³¨å…¥å¼ºåº¦ï¼ˆé»˜è®¤ 0.8ï¼‰

**å…³é”®æŠ€æœ¯**ï¼š
1. **æ„ŸçŸ¥æƒé‡**: å¯¹æ•°åŸŸå¢å¼ºå¤„ç†ï¼Œè‡ªé€‚åº”è®¡ç®—æ¯ä¸ªé¢‘ç‡çš„é‡è¦æ€§
2. **èƒ½é‡å¯¹é½**: ç¡®ä¿æ³¨å…¥ä¿¡å·ä¸åŸå§‹é¢‘è°±åŠŸç‡å¯†åº¦åŒ¹é…
3. **æ ‡å‡†åŒ–æ£€æµ‹**: ç‰¹å¾å‘é‡æ ‡å‡†åŒ– + å¤æ•°ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—

**æ£€æµ‹æŒ‡æ ‡**ï¼š
- æ£€æµ‹é˜ˆå€¼: 0.2920ï¼ˆåŸºäº ROC æ›²çº¿ä¼˜åŒ–ï¼‰
- çœŸé˜³æ€§ç‡ (TPR): 96.00%
- çœŸé˜´æ€§ç‡ (TNR): 100.00%
- AUC: 1.0000ï¼ˆå®Œç¾åˆ†ç¦»ï¼‰

### å¤šå¯†é’¥è¯†åˆ«ç®—æ³•

RingID ä½¿ç”¨ DDIM é€†å‘ + é¢‘åŸŸç›¸ä¼¼åº¦åŒ¹é…ï¼š
```python
1. å¯¹å¾…æ£€æµ‹å›¾åƒè¿›è¡Œ DDIM é€†å‘ï¼Œå¾—åˆ°åˆå§‹æ½œå˜é‡
2. æå–æ½œå˜é‡çš„é¢‘åŸŸç‰¹å¾
3. ä¸æ‰€æœ‰å€™é€‰å¯†é’¥çš„ç›®æ ‡ Patch è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
4. é€‰æ‹©ç›¸ä¼¼åº¦æœ€é«˜çš„å¯†é’¥ä½œä¸ºè¯†åˆ«ç»“æœ
```

### æ•°æ®å¤„ç†æµç¨‹ (æˆå‘˜ D)

```
åŸå§‹å®éªŒæ•°æ® (log.csv, PAI_results.txt)
    â†“
æ•°æ®æ¸…æ´—ä¸æ•´åˆ
    â†“
ç»Ÿè®¡åˆ†æ (å‡å€¼ã€æ–¹å·®ã€ç½®ä¿¡åŒºé—´)
    â†“
å¯è§†åŒ–ç”Ÿæˆ (æ›²çº¿å›¾ã€æ··æ·†çŸ©é˜µã€å¯¹æ¯”å›¾)
    â†“
æŠ¥å‘Šæ’°å†™ (Markdown + LaTeX)
```

## å¼•ç”¨

å¦‚æœæœ¬é¡¹ç›®å¯¹æ‚¨çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·å¼•ç”¨ä»¥ä¸‹è®ºæ–‡ï¼š

```bibtex
@inproceedings{wen2023tree,
  title={Tree-Ring Watermarks: Fingerprints for Diffusion Images that are Invisible and Robust},
  author={Wen, Yuxin and Kirchenbauer, John and Geiping, Jonas and Goldstein, Tom},
  booktitle={Advances in Neural Information Processing Systems},
  volume={36},
  pages={58047--58063},
  year={2023}
}

@article{wen2024ringid,
  title={RingID: Rethinking Tree-Ring Watermarks for Enhanced Multi-Key Identification},
  author={Wen, Yuxin and Kirchenbauer, John and Geiping, Jonas and Goldstein, Tom},
  journal={arXiv preprint arXiv:2404.14055},
  year={2024}
}

@article{liu2026pai,
  title={Attack-Resistant Watermarking for AIGC Image Forensics via Diffusion-Based Semantic Deflection},
  author={Liu, Qichao and Zhang, Yiming and Ba, Zhongjie and Shuai, Chengyu and Cheng, Pengcheng and Zheng, Tianhao and Wang, Zhan},
  journal={arXiv preprint arXiv:2601.06639},
  year={2026}
}
```

## è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹å¼€æºå·¥ä½œï¼š
- [Tree-Ring Watermark](https://github.com/YuxinWenRick/tree-ring-watermark) - åŸå§‹ Tree-Ring å®ç°
- [Stable Diffusion](https://github.com/Stability-AI/stablediffusion) - æ‰©æ•£æ¨¡å‹åŸºç¡€
- [Diffusers](https://github.com/huggingface/diffusers) - Hugging Face æ‰©æ•£æ¨¡å‹åº“

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…çš„è¾›å‹¤å·¥ä½œï¼


